---
import { navigationLinks } from '../utils/navigation-links.js'
import data from '../globals/settings.json';


const path = Astro.request.url.pathname;
const [content] = Astro.fetchContent('../globals/navigation.md');

// Second param must match what is set it the admin.
const headerNavigation = navigationLinks(content, 'Header Navigation');

---

<section class="relative">
    <div class="flex items-center justify-between h-20 mx-auto max-w-7xl">
        <div class="pr-8">
            <a href="/" class="relative z-10 flex self-stretch w-auto px-8 text-2xl font-extrabold leading-none text-gray-900 select-none">
                {data.company_name}<span class="text-green-500">.</span>
            </a>

            <nav class="items-center justify-center hidden space-x-8 text-gray-900 md:flex">
                {headerNavigation[0].map((item) => {
                const link = item.link.replace("src/content/pages", "");
                const newLink = link.replace("src/pages", "");
                const newnewLink = newLink.replace("index.md", "");
                const finalLink = newnewLink.replace(".md", "");
                return (
                    <a href={finalLink} class="relative inline-block text-base font-bold text-gray-700 transition duration-150 ease">
                    <span class="block">{item.link_name}</span>
                </a>
                );
                })}
            </nav>
        </div>
        <button class="flex items-center justify-center h-full px-8 text-gray-900 md:hidden js-show-mobile-menu-button">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8h16M4 16h16"></path>
            </svg>
        </button>
        <div class="fixed top-0 z-50 hidden w-full p-2 js-mobile-menu">
            <div class="p-5 bg-gray-100 rounded">
                {headerNavigation[0].map((item) => {
                const link = item.link.replace("src/content/pages", "");
                const newLink = link.replace("src/pages", "");
                const newnewLink = newLink.replace("index.md", "");
                const finalLink = newnewLink.replace(".md", "");
                return (
                <a href={finalLink} class="block p-4 text-base font-bold text-gray-700 transition duration-150 blockrelative ease">
                    {item.link_name}
                </a>
                );
                })}
                <button class="js-hide-mobile-menu-button">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8h16M4 16h16"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>
</section>

<script>
    const show = document.querySelector(".js-show-mobile-menu-button");
    const hide = document.querySelector(".js-hide-mobile-menu-button");
    const menu = document.querySelector(".js-mobile-menu");

    show.addEventListener("click", () => {
        menu.classList.remove("hidden");
    });
    hide.addEventListener("click", () => {
        menu.classList.add("hidden");
    });
</script>

